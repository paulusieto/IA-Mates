""<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ source }} - {{ qtype|upper }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<header>
  <button class="menu-button" onclick="toggleSidebar()">‚ò∞ Menu</button>
  {{ qtype|upper }} - {{ source }}
</header>

<div id="sidebar">
  <button class="close-button" onclick="toggleSidebar()">‚úñ</button>
  <ul>
    <li><a href="/menu/EPAC/qcm">EPAC - QCM</a></li>
    <li><a href="/menu/EPAC/open">EPAC - OPEN</a></li>
    <li><a href="/menu/Pre-Exam/qcm">Pre-Exam - QCM</a></li>
    <li><a href="/menu/Pre-Exam/open">Pre-Exam - OPEN</a></li>
    <li><a href="/menu/Paper D/qcm">Paper D - QCM</a></li>
    <li><a href="/menu/Paper D/open">Paper D - OPEN</a></li>
  </ul>
</div>

<div class="chatbox" id="chatbox">
  {% if questions|length > 0 %}
    <div class="message bot" id="questionText">{{ questions[0].question }}</div>
    <div class="choices" id="choicesBox">
      <button onclick="selectAnswer('A')">A</button>
      <button onclick="selectAnswer('B')">B</button>
      <button onclick="selectAnswer('C')">C</button>
      <button onclick="selectAnswer('D')">D</button>
    </div>
    <div class="message bot" id="feedback"></div>
    <input type="hidden" id="chunkId" value="{{ questions[0].chunk_id }}">
  {% else %}
    <div class="message bot">No questions available for this section.</div>
  {% endif %}
</div>

<script>
function toggleSidebar() {
  document.getElementById("sidebar").classList.toggle("active");
  document.body.classList.toggle("sidebar-active");
}

function selectAnswer(letter) {
  const chunkId = document.getElementById("chunkId").value;
  fetch("/api/check", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({chunk_id: chunkId, user_answer: letter})
  })
  .then(res => res.json())
  .then(data => {
    const feedback = document.getElementById("feedback");
    if (data.correct === true) {
      feedback.innerHTML = `‚úÖ Bonne r√©ponse. ${data.explanation}`;
    } else if (data.correct === false) {
      feedback.innerHTML = `‚ùå Mauvaise r√©ponse. La bonne r√©ponse √©tait ${data.correct_letter}.<br><br>${data.explanation}`;
    } else {
      feedback.innerHTML = `ü§ñ ${data.explanation}`;
    }
  });
}
</script>

</body>
</html>
